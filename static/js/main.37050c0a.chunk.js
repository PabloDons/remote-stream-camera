(this["webpackJsonpremote-stream-camera"]=this["webpackJsonpremote-stream-camera"]||[]).push([[0],{14:function(e,t,c){},15:function(e,t,c){},23:function(e,t){function c(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}c.keys=function(){return[]},c.resolve=c,e.exports=c,c.id=23},26:function(e,t,c){"use strict";c.r(t);var n=c(1),r=c.n(n),o=c(6),i=c.n(o),s=(c(14),c(2)),a=(c(15),c(28)),d=c(4),u=c.n(d),l=c(0);var j=function(){var e=Object(n.useState)(a.a),t=Object(s.a)(e,1)[0],c=u.a.resolve(window.location.href,u.a.format({query:{id:t,host:"true"}})),r=u.a.resolve(window.location.href,u.a.format({query:{id:t}}));return Object(l.jsx)("div",{children:Object(l.jsxs)("table",{children:[Object(l.jsx)("thead",{children:Object(l.jsx)("tr",{children:Object(l.jsx)("td",{children:"please use these urls for each stream:"})})}),Object(l.jsxs)("tbody",{children:[Object(l.jsxs)("tr",{children:[Object(l.jsx)("td",{children:"For"}),Object(l.jsx)("td",{children:"url"})]}),Object(l.jsxs)("tr",{children:[Object(l.jsx)("td",{children:"Stream host"}),Object(l.jsx)("td",{children:Object(l.jsx)("a",{href:c,children:c})})]}),Object(l.jsxs)("tr",{children:[Object(l.jsx)("td",{children:"Stream guest"}),Object(l.jsx)("td",{children:Object(l.jsx)("a",{href:r,children:r})})]})]})]})})},f=c(5),b=c.n(f),O=c(3),h=c.n(O),v=c(8),x=c.n(v),m=function(){var e=new h.a(window.location.href,!0).query,t=Object(n.useState)(),c=Object(s.a)(t,2),r=c[0],o=c[1],i=Object(n.useState)(),a=Object(s.a)(i,2),d=a[0],u=a[1],j=Object(n.useState)(!1),f=Object(s.a)(j,2),O=f[0],v=f[1],m=Object(n.useState)(),w=Object(s.a)(m,2),y=w[0],g=w[1],p=Object(n.useRef)(null);return Object(n.useEffect)((function(){if(!d||d.disconnected||d.destroyed){if(!d||d.destroyed){d&&d.destroy();var t=new b.a(e.id);return t.on("open",(function(e){v(!0),console.log("client ready with ID: ".concat(e))})),t.on("error",(function(){return v(!1)})),t.on("disconnected",(function(){return v(!1)})),t.on("call",(function(e){console.log("recieved call from ".concat(e.peer)),y&&y.close(),e.on("stream",(function(e){o(e)})),e.answer(),g(e)})),u(t),function(){d&&(d.destroy(),u(void 0)),v(!1)}}d.reconnect()}}),[O]),Object(n.useEffect)((function(){r&&(p.current.srcObject=r)}),[r]),Object(l.jsx)("div",{className:x.a.container,children:Object(l.jsx)("video",{className:x.a.stream,ref:p,autoPlay:!0})})};function w(e){console.log("navigator.MediaDevices.getUserMedia error: ",e.message,e.name)}var y=function(){var e,t=new h.a(window.location.href,!0).query,c=Object(n.useState)([]),r=Object(s.a)(c,2),o=r[0],i=r[1],a=Object(n.useState)(),d=Object(s.a)(a,2),u=d[0],j=d[1],f=Object(n.useState)(),O=Object(s.a)(f,2),v=O[0],x=O[1],m=Object(n.useState)(!1),y=Object(s.a)(m,2),g=y[0],p=y[1],S=Object(n.useRef)(null),E=Object(n.useRef)(null),I=Object(n.useState)(),D=Object(s.a)(I,2),F=D[0],M=D[1];return Object(n.useEffect)((function(){var e;M(null===(e=E.current)||void 0===e?void 0:e.value)}),[null===(e=E.current)||void 0===e?void 0:e.value]),Object(n.useEffect)((function(){navigator.mediaDevices.enumerateDevices().then((function(e){i(e)})).catch(w)}),[u]),Object(n.useEffect)((function(){if(!v||v.disconnected||v.destroyed){if(v&&!v.destroyed)return v.reconnect(),void p(!0);v&&(p(!1),v.destroy());var e=new b.a;return e.on("open",(function(e){p(!0),console.log("client ready with ID: ".concat(e))})),e.on("error",(function(e){console.error(e),p(!1)})),e.on("disconnected",(function(e){console.error(e),p(!1)})),x(e),function(){v&&(v.destroy(),x(void 0)),p(!1)}}}),[null===v||void 0===v?void 0:v.disconnected,null===v||void 0===v?void 0:v.destroyed]),Object(n.useEffect)((function(){if(void 0!==F){var e={audio:!1,video:{deviceId:!F||{exact:F}}};navigator.mediaDevices.getUserMedia(e).then((function(e){j(e),S.current.srcObject=e})).catch(w)}}),[F]),Object(n.useEffect)((function(){if(g&&u){console.log("calling peerId ".concat(t.id));var e=v.call(t.id,u);return function(){e.close()}}}),[t.id,u,g,v]),Object(l.jsxs)("div",{children:[Object(l.jsxs)("div",{id:"container",children:[Object(l.jsxs)("p",{children:[Object(l.jsx)("b",{children:"Note:"})," without permission, the browser will restrict the available devices to at most one per type."]}),Object(l.jsx)("div",{className:"select",children:Object(l.jsxs)("label",{htmlFor:E.current,children:["Video source: ",Object(l.jsx)("select",{ref:E,onChange:function(){var e;M(null===(e=E.current)||void 0===e?void 0:e.value)},children:o&&o.filter((function(e){return"videoinput"===e.kind&&e.deviceId})).map((function(e,t){return Object(l.jsx)("option",{value:e.deviceId,children:e.label||"camera ".concat(t)},e.deviceId)}))})]})})]}),Object(l.jsx)("video",{style:{width:"80vw"},ref:S,autoPlay:!0})]})},g=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,29)).then((function(t){var c=t.getCLS,n=t.getFID,r=t.getFCP,o=t.getLCP,i=t.getTTFB;c(e),n(e),r(e),o(e),i(e)}))},p=new h.a(window.location.href,!0).query;p.id?"true"===p.host?i.a.render(Object(l.jsx)(r.a.StrictMode,{children:Object(l.jsx)(m,{})}),document.getElementById("root")):i.a.render(Object(l.jsx)(r.a.StrictMode,{children:Object(l.jsx)(y,{})}),document.getElementById("root")):i.a.render(Object(l.jsx)(r.a.StrictMode,{children:Object(l.jsx)(j,{})}),document.getElementById("root")),g()},8:function(e,t,c){e.exports={stream:"HostApp_stream__KfcOx"}}},[[26,1,2]]]);
//# sourceMappingURL=main.37050c0a.chunk.js.map