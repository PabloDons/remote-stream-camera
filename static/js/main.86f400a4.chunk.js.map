{"version":3,"sources":["../node_modules/peerjs/dist sync","App.js","HostApp.js","GuestApp.js","reportWebVitals.js","index.js","HostApp.module.css"],"names":["webpackEmptyContext","req","e","Error","code","keys","resolve","module","exports","id","App","useState","v4","hostUrl","url","window","location","href","format","query","host","clientUrl","HostApp","params","Url","stream","setStream","peer","setPeer","peerReady","setPeerReady","currentConn","setCurrentConn","refVideo","useRef","useEffect","disconnected","destroyed","destroy","newPeer","Peer","on","console","log","call","close","answer","undefined","reconnect","current","srcObject","className","css","container","ref","autoPlay","handleError","error","message","name","GuestApp","deviceInfos","setDeviceInfos","userStream","setUserStream","refVideoSource","videoSource","setVideoSource","value","navigator","mediaDevices","enumerateDevices","then","devices","catch","err","constraints","audio","video","deviceId","exact","getUserMedia","conn","htmlFor","onChange","filter","deviceInfo","kind","map","index","label","style","width","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","searchParams","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.86f400a4.chunk.js","sourcesContent":["function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 23;","import \"./App.css\";\nimport { useState } from \"react\";\nimport { v4 } from \"uuid\";\nimport url from \"url\";\n\nfunction App() {\n  const [id] = useState(v4);\n  const hostUrl = url.resolve(window.location.href, url.format({ query: { id, host: \"true\" } }));\n  const clientUrl = url.resolve(window.location.href, url.format({ query: { id } }));\n\n  return (\n    <div>\n      <h1>\n        remote-stream-camera (<a href={\"https://github.com/PabloDons/remote-stream-camera\"}>github</a>)\n      </h1>\n      <table>\n        <thead>\n          <tr>\n            <td>{\"URLs you need:\"}</td>\n          </tr>\n        </thead>\n        <tbody>\n          <tr>\n            <td>For</td>\n            <td>url</td>\n          </tr>\n          <tr>\n            <td>Stream host</td>\n            <td>\n              <a href={hostUrl}>{hostUrl}</a>\n            </td>\n          </tr>\n          <tr>\n            <td>Stream guest</td>\n            <td>\n              <a href={clientUrl}>{clientUrl}</a>\n            </td>\n          </tr>\n        </tbody>\n      </table>\n    </div>\n  );\n}\n\nexport default App;\n","import Peer from \"peerjs\";\r\nimport { useEffect, useRef, useState } from \"react\";\r\nimport Url from \"url-parse\";\r\nimport css from \"./HostApp.module.css\";\r\n\r\nconst HostApp = () => {\r\n  const params = new Url(window.location.href, true).query;\r\n  const [stream, setStream] = useState();\r\n  const [peer, setPeer] = useState();\r\n  const [peerReady, setPeerReady] = useState(false);\r\n  const [currentConn, setCurrentConn] = useState();\r\n  const refVideo = useRef(null);\r\n\r\n  useEffect(() => {\r\n    if (peer && !peer.disconnected && !peer.destroyed) return;\r\n    if (peer && !peer.destroyed) {\r\n      peer.reconnect();\r\n      return;\r\n    }\r\n\r\n    if (peer) peer.destroy();\r\n\r\n    const newPeer = new Peer(params.id);\r\n\r\n    newPeer.on(\"open\", id => {\r\n      setPeerReady(true);\r\n      console.log(`client ready with ID: ${id}`);\r\n    });\r\n\r\n    newPeer.on(\"error\", () => setPeerReady(false));\r\n    newPeer.on(\"disconnected\", () => setPeerReady(false));\r\n\r\n    newPeer.on(\"call\", call => {\r\n      console.log(`recieved call from ${call.peer}`);\r\n      if (currentConn) currentConn.close();\r\n      call.on(\"stream\", stream => {\r\n        setStream(stream);\r\n      });\r\n      call.answer();\r\n      setCurrentConn(call);\r\n    });\r\n\r\n    setPeer(newPeer);\r\n\r\n    return () => {\r\n      if (peer) {\r\n        peer.destroy();\r\n        setPeer(undefined);\r\n      }\r\n      setPeerReady(false);\r\n    };\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [peerReady]);\r\n\r\n  useEffect(() => {\r\n    if (!stream) return;\r\n    refVideo.current.srcObject = stream;\r\n  }, [stream]);\r\n\r\n  return (\r\n    <div className={css.container}>\r\n      <video className={css.stream} ref={refVideo} autoPlay></video>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default HostApp;\r\n","/*\r\nBased on this webrtc sample https://github.com/webrtc/samples/tree/gh-pages/src/content/devices/input-output\r\n*/\r\n\r\nimport Peer from \"peerjs\";\r\nimport { useEffect, useRef, useState } from \"react\";\r\nimport Url from \"url-parse\";\r\n\r\nfunction handleError(error) {\r\n  console.log(\"navigator.MediaDevices.getUserMedia error: \", error.message, error.name);\r\n}\r\n\r\nconst GuestApp = () => {\r\n  const params = new Url(window.location.href, true).query;\r\n\r\n  const [deviceInfos, setDeviceInfos] = useState([]);\r\n  const [userStream, setUserStream] = useState();\r\n  const [peer, setPeer] = useState();\r\n  const [peerReady, setPeerReady] = useState(false);\r\n\r\n  const refVideo = useRef(null);\r\n  const refVideoSource = useRef(null);\r\n  const [videoSource, setVideoSource] = useState();\r\n\r\n  useEffect(() => {\r\n    setVideoSource(refVideoSource.current?.value);\r\n  }, [refVideoSource.current?.value]);\r\n\r\n  useEffect(() => {\r\n    navigator.mediaDevices\r\n      .enumerateDevices()\r\n      .then(devices => {\r\n        setDeviceInfos(devices);\r\n      })\r\n      .catch(handleError);\r\n  }, [userStream]);\r\n\r\n  useEffect(() => {\r\n    if (peer && !peer.disconnected && !peer.destroyed) return;\r\n    if (peer && !peer.destroyed) {\r\n      peer.reconnect();\r\n      setPeerReady(true);\r\n      return;\r\n    }\r\n\r\n    if (peer) {\r\n      setPeerReady(false);\r\n      peer.destroy();\r\n    }\r\n\r\n    const newPeer = new Peer();\r\n\r\n    newPeer.on(\"open\", id => {\r\n      setPeerReady(true);\r\n      console.log(`client ready with ID: ${id}`);\r\n    });\r\n\r\n    newPeer.on(\"error\", err => {\r\n      console.error(err);\r\n      setPeerReady(false);\r\n    });\r\n    newPeer.on(\"disconnected\", err => {\r\n      console.error(err);\r\n      setPeerReady(false);\r\n    });\r\n\r\n    setPeer(newPeer);\r\n\r\n    return () => {\r\n      if (peer) {\r\n        peer.destroy();\r\n        setPeer(undefined);\r\n      }\r\n      setPeerReady(false);\r\n    };\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [peer?.disconnected, peer?.destroyed]);\r\n\r\n  useEffect(() => {\r\n    if (videoSource === undefined) return;\r\n    const constraints = {\r\n      audio: false,\r\n      video: { deviceId: videoSource ? { exact: videoSource } : true },\r\n    };\r\n    navigator.mediaDevices\r\n      .getUserMedia(constraints)\r\n      .then(stream => {\r\n        setUserStream(stream);\r\n        refVideo.current.srcObject = stream;\r\n      })\r\n      .catch(handleError);\r\n  }, [videoSource]);\r\n\r\n  useEffect(() => {\r\n    if (!peerReady) return;\r\n    if (!userStream) return;\r\n\r\n    console.log(`calling peerId ${params.id}`);\r\n    const conn = peer.call(params.id, userStream);\r\n\r\n    return () => {\r\n      conn.close();\r\n    };\r\n  }, [params.id, userStream, peerReady, peer]);\r\n\r\n  function onChangeVideoSource() {\r\n    setVideoSource(refVideoSource.current?.value);\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <h1>\r\n        remote-stream-camera (<a href={\"https://github.com/PabloDons/remote-stream-camera\"}>github</a>)\r\n      </h1>\r\n      <div id=\"container\">\r\n        <p>\r\n          <b>Note:</b> without permission, the browser will restrict the available devices to at most one per type.\r\n        </p>\r\n        <div className=\"select\">\r\n          <label htmlFor={refVideoSource.current}>\r\n            {\"Video source: \"}\r\n            <select ref={refVideoSource} onChange={onChangeVideoSource}>\r\n              {deviceInfos &&\r\n                deviceInfos\r\n                  .filter(deviceInfo => deviceInfo.kind === \"videoinput\" && deviceInfo.deviceId)\r\n                  .map((deviceInfo, index) => (\r\n                    <option key={deviceInfo.deviceId} value={deviceInfo.deviceId}>\r\n                      {deviceInfo.label || `camera ${index}`}\r\n                    </option>\r\n                  ))}\r\n            </select>\r\n          </label>\r\n        </div>\r\n      </div>\r\n      <video style={{ width: \"80vw\" }} ref={refVideo} autoPlay />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default GuestApp;\r\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport HostApp from \"./HostApp\";\nimport GuestApp from \"./GuestApp\";\nimport reportWebVitals from \"./reportWebVitals\";\nimport Url from \"url-parse\";\n\nconst searchParams = (new Url(window.location.href, true)).query;\n\nif (searchParams.id) {\n  if (searchParams.host === \"true\") {\n    ReactDOM.render(\n      <React.StrictMode>\n        <HostApp />\n      </React.StrictMode>,\n      document.getElementById(\"root\")\n    );\n  } else {\n    ReactDOM.render(\n      <React.StrictMode>\n        <GuestApp />\n      </React.StrictMode>,\n      document.getElementById(\"root\")\n    );\n  }\n} else {\n  ReactDOM.render(\n    <React.StrictMode>\n      <App />\n    </React.StrictMode>,\n    document.getElementById(\"root\")\n  );\n}\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"stream\":\"HostApp_stream__KfcOx\"};"],"sourceRoot":""}