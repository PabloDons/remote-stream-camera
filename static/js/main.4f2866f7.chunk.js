(this["webpackJsonpremote-stream-camera"]=this["webpackJsonpremote-stream-camera"]||[]).push([[0],{14:function(e,t,c){},15:function(e,t,c){},23:function(e,t){function c(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}c.keys=function(){return[]},c.resolve=c,e.exports=c,c.id=23},26:function(e,t,c){"use strict";c.r(t);var n=c(1),r=c.n(n),o=c(6),i=c.n(o),a=(c(14),c(2)),s=(c(15),c(28)),d=c(4),u=c.n(d),l=c(0);var j=function(){var e=Object(n.useState)(s.a),t=Object(a.a)(e,1)[0],c=u.a.resolve(window.location.href,u.a.format({query:{id:t,host:"true"}})),r=u.a.resolve(window.location.href,u.a.format({query:{id:t}}));return Object(l.jsxs)("div",{children:[Object(l.jsxs)("h1",{children:["remote-stream-camera (",Object(l.jsx)("a",{href:"https://github.com/PabloDons/remote-stream-camera",children:"github"}),")"]}),Object(l.jsxs)("table",{children:[Object(l.jsx)("thead",{children:Object(l.jsx)("tr",{children:Object(l.jsx)("td",{children:"URLs you need:"})})}),Object(l.jsxs)("tbody",{children:[Object(l.jsxs)("tr",{children:[Object(l.jsx)("td",{children:"For"}),Object(l.jsx)("td",{children:"url"})]}),Object(l.jsxs)("tr",{children:[Object(l.jsx)("td",{children:"Stream host"}),Object(l.jsx)("td",{children:Object(l.jsx)("a",{href:c,children:c})})]}),Object(l.jsxs)("tr",{children:[Object(l.jsx)("td",{children:"Stream guest"}),Object(l.jsx)("td",{children:Object(l.jsx)("a",{href:r,children:r})})]})]})]})]})},b=c(5),f=c.n(b),O=c(3),h=c.n(O),v=c(8),m=c.n(v),x=function(){var e=new h.a(window.location.href,!0).query,t=Object(n.useState)(),c=Object(a.a)(t,2),r=c[0],o=c[1],i=Object(n.useState)(),s=Object(a.a)(i,2),d=s[0],u=s[1],j=Object(n.useState)(!1),b=Object(a.a)(j,2),O=b[0],v=b[1],x=Object(n.useState)(),g=Object(a.a)(x,2),p=g[0],w=g[1],y=Object(n.useRef)(null);return Object(n.useEffect)((function(){if(!d||d.disconnected||d.destroyed){if(!d||d.destroyed){d&&d.destroy();var t=new f.a(e.id);return t.on("open",(function(e){v(!0),console.log("client ready with ID: ".concat(e))})),t.on("error",(function(){return v(!1)})),t.on("disconnected",(function(){return v(!1)})),t.on("call",(function(e){console.log("recieved call from ".concat(e.peer)),p&&p.close(),e.on("stream",(function(e){o(e)})),e.answer(),w(e)})),u(t),function(){d&&(d.destroy(),u(void 0)),v(!1)}}d.reconnect()}}),[O]),Object(n.useEffect)((function(){r&&(y.current.srcObject=r)}),[r]),Object(l.jsx)("div",{className:m.a.container,children:Object(l.jsx)("video",{className:m.a.stream,ref:y,autoPlay:!0})})};function g(e){console.log("navigator.MediaDevices.getUserMedia error: ",e.message,e.name)}var p=function(){var e,t,c=new h.a(window.location.href,!0).query,r=Object(n.useState)([]),o=Object(a.a)(r,2),i=o[0],s=o[1],d=Object(n.useState)(),u=Object(a.a)(d,2),j=u[0],b=u[1],O=Object(n.useState)(),v=Object(a.a)(O,2),m=v[0],x=v[1],p=Object(n.useState)(!1),w=Object(a.a)(p,2),y=w[0],S=w[1],I=Object(n.useRef)(null),E=Object(n.useRef)(null),D=Object(n.useRef)(null),M=Object(n.useState)(),N=Object(a.a)(M,2),C=N[0],F=N[1],P=Object(n.useState)(),k=Object(a.a)(P,2),q=k[0],R=k[1];return Object(n.useEffect)((function(){var e;F(null===(e=E.current)||void 0===e?void 0:e.value)}),[null===(e=E.current)||void 0===e?void 0:e.value]),Object(n.useEffect)((function(){var e;R(null===(e=D.current)||void 0===e?void 0:e.value)}),[null===(t=D.current)||void 0===t?void 0:t.value]),Object(n.useEffect)((function(){navigator.mediaDevices.enumerateDevices().then((function(e){s(e)})).catch(g)}),[j]),Object(n.useEffect)((function(){if(!m||m.disconnected||m.destroyed){if(m&&!m.destroyed)return m.reconnect(),void S(!0);m&&(S(!1),m.destroy());var e=new f.a;return e.on("open",(function(e){S(!0),console.log("client ready with ID: ".concat(e))})),e.on("error",(function(e){console.error(e),S(!1)})),e.on("disconnected",(function(e){console.error(e),S(!1)})),x(e),function(){m&&(m.destroy(),x(void 0)),S(!1)}}}),[null===m||void 0===m?void 0:m.disconnected,null===m||void 0===m?void 0:m.destroyed]),Object(n.useEffect)((function(){if(void 0!==C&&void 0!==q){var e={audio:"none"!==q&&{deviceId:!q||{exact:q}},video:{deviceId:!C||{exact:C}}};navigator.mediaDevices.getUserMedia(e).then((function(e){b(e),I.current.srcObject=e})).catch(g)}}),[q,C]),Object(n.useEffect)((function(){if(y&&j){console.log("calling peerId ".concat(c.id));var e=m.call(c.id,j);return function(){e.close()}}}),[c.id,j,y,m]),Object(l.jsxs)("div",{children:[Object(l.jsxs)("h1",{children:["remote-stream-camera (",Object(l.jsx)("a",{href:"https://github.com/PabloDons/remote-stream-camera",children:"github"}),")"]}),Object(l.jsxs)("div",{id:"container",children:[Object(l.jsxs)("p",{children:[Object(l.jsx)("b",{children:"Note:"})," without permission, the browser will restrict the available devices to at most one per type."]}),Object(l.jsxs)("div",{className:"select",children:[Object(l.jsxs)("label",{children:["Video source: ",Object(l.jsx)("select",{ref:E,onChange:function(){var e;F(null===(e=E.current)||void 0===e?void 0:e.value)},children:i&&i.filter((function(e){return"videoinput"===e.kind&&e.deviceId})).map((function(e,t){return Object(l.jsx)("option",{value:e.deviceId,children:e.label||"camera ".concat(t)},e.deviceId)}))})]}),Object(l.jsxs)("label",{children:["Audio source: ",Object(l.jsxs)("select",{ref:D,onChange:function(){var e;R(null===(e=D.current)||void 0===e?void 0:e.value)},children:[i&&i.filter((function(e){return"audioinput"===e.kind&&e.deviceId})).map((function(e,t){return Object(l.jsx)("option",{value:e.deviceId,children:e.label||"microphone ".concat(t)},e.deviceId)})),Object(l.jsx)("option",{value:"none",children:"None"})]})]})]})]}),Object(l.jsx)("video",{style:{width:"80vw"},ref:I,autoPlay:!0})]})},w=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,29)).then((function(t){var c=t.getCLS,n=t.getFID,r=t.getFCP,o=t.getLCP,i=t.getTTFB;c(e),n(e),r(e),o(e),i(e)}))},y=new h.a(window.location.href,!0).query;y.id?"true"===y.host?i.a.render(Object(l.jsx)(r.a.StrictMode,{children:Object(l.jsx)(x,{})}),document.getElementById("root")):i.a.render(Object(l.jsx)(r.a.StrictMode,{children:Object(l.jsx)(p,{})}),document.getElementById("root")):i.a.render(Object(l.jsx)(r.a.StrictMode,{children:Object(l.jsx)(j,{})}),document.getElementById("root")),w()},8:function(e,t,c){e.exports={stream:"HostApp_stream__KfcOx"}}},[[26,1,2]]]);
//# sourceMappingURL=main.4f2866f7.chunk.js.map